---
title: "Data Preprocessing and Excluding"
author: "anjie"
date: "10/14/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(DT)
library(jsonlite)
library(tidyverse)
library(kableExtra)
RAW_DATA_DIR <- here("raw_data/")
AGGREGATED_DATA_PATH <- here("processed_data/aggregated_data.csv")
```

# Aggregate the Raw Data 
```{r}
raw_df <- list.files(RAW_DATA_DIR, full.names = T) %>%
  map_df(read_csv) %>% 
  select(rt, trial_type, trial_index, subject, trial_stimulus, trial_stimulus_type, 
         task_type, task_target_stimulus, task_background_stimulus, task_deviant_stimuli, task_order_number, block_order_number, trial_looking_time, 
         trial_pressed_space_bar, responses, question_order) %>% 
  filter(trial_type == "stimulus-presentation" | trial_type == "demog-age" | trial_type == "demog-gender-and-education" | trial_type == "demog-ethnic-US" | trial_type == "demog-disorder-history") %>% 
  mutate(
    stimuli_type = case_when(
    grepl("complex", trial_stimulus) ~ "complex", 
    grepl("simple", trial_stimulus) ~ "simple"
  ))

write_csv(raw_df, AGGREGATED_DATA_PATH)
```

# Extract the Demog Information 
```{r}
raw_df %>% datatable()
```

# Exclusion criteria applied 


# final clean data 
